(function(window, angular, undefined) {
'use strict';
angular.module("keepr.directives",[]),angular.module("keepr.filters",[]),angular.module("keepr.services",[]),angular.module("keepr",["keepr.directives","keepr.filters","keepr.services"]),angular.module("keepr.directives").directive("kpFlipContent",function(){return{restrict:"EA",scope:{},link:function($scope,$elem,$attrs){var flip=function(){$elem.toggleClass("flipped")};$attrs.clickToggle&&$elem.bind("click",flip),$attrs.mouseoverToggle&&$elem.bind("mouseenter mouseleave",flip),$scope.$on("$destroy",function(){$elem.unbind("mouseenter mouseleave")})}}}),angular.module("keepr.directives").directive("kpFocus",function(){return{restrict:"A",require:"ngModel",link:function(scope,element,controller){controller.$focused=!1,element.bind("focus",function(){scope.$apply(function(){controller.$focused=!0})}).bind("blur",function(){scope.$apply(function(){controller.$focused=!1})}),scope.$on("$destroy",function(){element.unbind("blur focus")})}}}),angular.module("keepr.directives").directive("kpMask",function($parse){var maskConfig={maskDefinitions:{9:/\d/,A:/[a-zA-Z]/,g:/[a-z]/,G:/[A-Z]/,"*":/[a-zA-Z0-9]/}};return{priority:100,require:"ngModel",restrict:"A",compile:function(){var options=maskConfig;return function(scope,iElement,iAttrs,controller){function initialize(maskAttr){return angular.isDefined(maskAttr)?(processRawMask(maskAttr),maskProcessed?(initializeElement(),bindEventListeners(),!0):uninitialize()):uninitialize()}function initPlaceholder(placeholderAttr){angular.isDefined(placeholderAttr)&&(maskPlaceholder=placeholderAttr,maskProcessed&&eventHandler())}function formatter(fromModelValue){return maskProcessed?(value=unmaskValue(fromModelValue||""),isValid=validateValue(value),controller.$setValidity("mask",isValid),isValid&&value.length?maskValue(value):void 0):fromModelValue}function parser(fromViewValue){return maskProcessed?(value=unmaskValue(fromViewValue||""),isValid=validateValue(value),controller.$viewValue=value.length?maskValue(value):"",controller.$setValidity("mask",isValid),""===value&&void 0!==controller.$error.required&&controller.$setValidity("required",!1),isValid?value:void 0):fromViewValue}function uninitialize(){return maskProcessed=!1,unbindEventListeners(),angular.isDefined(originalPlaceholder)?iElement.attr("placeholder",originalPlaceholder):iElement.removeAttr("placeholder"),angular.isDefined(originalMaxlength)?iElement.attr("maxlength",originalMaxlength):iElement.removeAttr("maxlength"),iElement.val(controller.$modelValue),controller.$viewValue=controller.$modelValue,!1}function initializeElement(){value=oldValueUnmasked=unmaskValue(controller.$modelValue||""),valueMasked=oldValue=maskValue(value),isValid=validateValue(value);var viewValue=isValid&&value.length?valueMasked:"";iAttrs.maxlength&&iElement.attr("maxlength",2*maskCaretMap[maskCaretMap.length-1]),iElement.attr("placeholder",maskPlaceholder),iElement.val(viewValue),controller.$viewValue=viewValue,placeholderVerification()}function bindEventListeners(){eventsBound||(iElement.bind("blur",blurHandler),iElement.bind("mousedown mouseup",mouseDownUpHandler),iElement.bind("input keyup click focus",eventHandler),eventsBound=!0)}function unbindEventListeners(){eventsBound&&(iElement.unbind("blur",blurHandler),iElement.unbind("mousedown",mouseDownUpHandler),iElement.unbind("mouseup",mouseDownUpHandler),iElement.unbind("input",eventHandler),iElement.unbind("keyup",eventHandler),iElement.unbind("click",eventHandler),iElement.unbind("focus",eventHandler),eventsBound=!1)}function validateValue(value){return value.length?value.length>=minRequiredLength:!0}function unmaskValue(value){var valueUnmasked="",maskPatternsCopy=maskPatterns.slice();return value=value.toString(),angular.forEach(maskComponents,function(component){value=value.replace(component,"")}),angular.forEach(value.split(""),function(chr){maskPatternsCopy.length&&maskPatternsCopy[0].test(chr)&&(valueUnmasked+=chr,maskPatternsCopy.shift())}),valueUnmasked}function maskValue(unmaskedValue){var valueMasked="",maskCaretMapCopy=maskCaretMap.slice();return angular.forEach(maskPlaceholder.split(""),function(chr,i){unmaskedValue.length&&i===maskCaretMapCopy[0]?(valueMasked+=unmaskedValue.charAt(0)||"_",unmaskedValue=unmaskedValue.substr(1),maskCaretMapCopy.shift()):valueMasked+=chr}),valueMasked}function getPlaceholderChar(i){var placeholder=iAttrs.placeholder;return"undefined"!=typeof placeholder&&placeholder[i]?placeholder[i]:"_"}function getMaskComponents(){return maskPlaceholder.replace(/[_]+/g,"_").replace(/([^_]+)([a-zA-Z0-9])([^_])/g,"$1$2_$3").split("_")}function processRawMask(mask){var characterCount=0;if(maskCaretMap=[],maskPatterns=[],maskPlaceholder="","string"==typeof mask){minRequiredLength=0;var isOptional=!1,splitMask=mask.split("");angular.forEach(splitMask,function(chr,i){linkOptions.maskDefinitions[chr]?(maskCaretMap.push(characterCount),maskPlaceholder+=getPlaceholderChar(i),maskPatterns.push(linkOptions.maskDefinitions[chr]),characterCount++,isOptional||minRequiredLength++):"?"===chr?isOptional=!0:(maskPlaceholder+=chr,characterCount++)})}maskCaretMap.push(maskCaretMap.slice().pop()+1),maskComponents=getMaskComponents(),maskProcessed=maskCaretMap.length>1?!0:!1}function blurHandler(){oldCaretPosition=0,oldSelectionLength=0,isValid&&0!==value.length||!cleanField||(valueMasked="",iElement.val(""),scope.$apply(function(){controller.$setViewValue("")}))}function mouseDownUpHandler(e){"mousedown"===e.type?iElement.bind("mouseout",mouseoutHandler):iElement.unbind("mouseout",mouseoutHandler)}function mouseoutHandler(){oldSelectionLength=getSelectionLength(this),iElement.unbind("mouseout",mouseoutHandler)}function eventHandler(e){e=e||{};var eventWhich=e.which,eventType=e.type;if(16!==eventWhich&&91!==eventWhich){var valMasked,val=iElement.val(),valOld=oldValue,valUnmasked=unmaskValue(val),valUnmaskedOld=oldValueUnmasked,valAltered=!1,caretPos=getCaretPosition(this)||0,caretPosOld=oldCaretPosition||0,caretPosDelta=caretPos-caretPosOld,caretPosMin=maskCaretMap[0],caretPosMax=maskCaretMap[valUnmasked.length]||maskCaretMap.slice().shift(),selectionLenOld=oldSelectionLength||0,isSelected=getSelectionLength(this)>0,wasSelected=selectionLenOld>0,isAddition=val.length>valOld.length||selectionLenOld&&val.length>valOld.length-selectionLenOld,isDeletion=val.length<valOld.length||selectionLenOld&&val.length===valOld.length-selectionLenOld,isSelection=eventWhich>=37&&40>=eventWhich&&e.shiftKey,isKeyLeftArrow=37===eventWhich,isKeyBackspace=8===eventWhich||"keyup"!==eventType&&isDeletion&&-1===caretPosDelta,isKeyDelete=46===eventWhich||"keyup"!==eventType&&isDeletion&&0===caretPosDelta&&!wasSelected,caretBumpBack=(isKeyLeftArrow||isKeyBackspace||"click"===eventType)&&caretPos>caretPosMin;if(oldSelectionLength=getSelectionLength(this),!isSelection&&(!isSelected||"click"!==eventType&&"keyup"!==eventType)){if("input"===eventType&&isDeletion&&!wasSelected&&valUnmasked===valUnmaskedOld){for(;isKeyBackspace&&caretPos>caretPosMin&&!isValidCaretPosition(caretPos);)caretPos--;for(;isKeyDelete&&caretPosMax>caretPos&&-1===maskCaretMap.indexOf(caretPos);)caretPos++;var charIndex=maskCaretMap.indexOf(caretPos);valUnmasked=valUnmasked.substring(0,charIndex)+valUnmasked.substring(charIndex+1),valAltered=!0}for(valMasked=maskValue(valUnmasked),oldValue=valMasked,oldValueUnmasked=valUnmasked,iElement.val(valMasked),valAltered&&scope.$apply(function(){controller.$setViewValue(valUnmasked)}),isAddition&&caretPosMin>=caretPos&&(caretPos=caretPosMin+1),caretBumpBack&&caretPos--,caretPos=caretPos>caretPosMax?caretPosMax:caretPosMin>caretPos?caretPosMin:caretPos;!isValidCaretPosition(caretPos)&&caretPos>caretPosMin&&caretPosMax>caretPos;)caretPos+=caretBumpBack?-1:1;(caretBumpBack&&caretPosMax>caretPos||isAddition&&!isValidCaretPosition(caretPosOld))&&caretPos++,oldCaretPosition=caretPos,setCaretPosition(this,caretPos),placeholderVerification()}}}function placeholderVerification(){value=unmaskValue(controller.$viewValue||""),iElement.attr("placeholder",value.length>0?maskPlaceholder:iAttrs.kpPlaceholder)}function isValidCaretPosition(pos){return maskCaretMap.indexOf(pos)>-1}function getCaretPosition(input){if(!input)return 0;if(void 0!==input.selectionStart)return input.selectionStart;if(document.selection){input.focus();var selection=document.selection.createRange();return selection.moveStart("character",input.value?-input.value.length:0),selection.text.length}return 0}function setCaretPosition(input,pos){if(!input)return 0;if(0!==input.offsetWidth&&0!==input.offsetHeight)if(input.setSelectionRange)input.focus(),input.setSelectionRange(pos,pos);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getSelectionLength(input){return input?void 0!==input.selectionStart?input.selectionEnd-input.selectionStart:document.selection?document.selection.createRange().text.length:0:0}var maskCaretMap,maskPatterns,maskPlaceholder,maskComponents,minRequiredLength,value,valueMasked,isValid,oldValue,oldValueUnmasked,oldCaretPosition,oldSelectionLength,maskProcessed=!1,eventsBound=!1,originalPlaceholder=iAttrs.placeholder,originalMaxlength=iAttrs.maxlength,cleanField=!angular.isUndefined(iAttrs.kpCleanField)&&"true"===iAttrs.kpCleanField,linkOptions={};iAttrs.uiOptions?(linkOptions=scope.$eval("["+iAttrs.uiOptions+"]"),angular.isObject(linkOptions[0])&&(linkOptions=function(original,current){for(var i in original)Object.prototype.hasOwnProperty.call(original,i)&&(current[i]?angular.extend(current[i],original[i]):current[i]=angular.copy(original[i]));return current}(options,linkOptions[0]))):linkOptions=options,iAttrs.$observe("kpMask",initialize),iAttrs.$observe("placeholder",initPlaceholder);var modelViewValue=!1;iAttrs.$observe("modelViewValue",function(val){"true"===val&&(modelViewValue=!0)}),scope.$watch(iAttrs.ngModel,function(val){if(modelViewValue&&val){var model=$parse(iAttrs.ngModel);model.assign(scope,controller.$viewValue)}}),controller.$formatters.push(formatter),controller.$parsers.push(parser),iElement.bind("mousedown mouseup",mouseDownUpHandler),Array.prototype.indexOf||(Array.prototype.indexOf=function(searchElement){if(null===this)throw new TypeError;var t=Object(this),len=t.length>>>0;if(0===len)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&1/0!==n&&n!==-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=len)return-1;for(var k=n>=0?n:Math.max(len-Math.abs(n),0);len>k;k++)if(k in t&&t[k]===searchElement)return k;return-1})}}}}),angular.module("keepr.directives").directive("kpPrintContent",function(){return{restrict:"A",scope:{printOptions:"=printOptions"},link:{post:function($scope,$el){var printOptions={removeBind:!1,target:"body",title:"Print",alert:!0,css:[]};angular.extend(printOptions,$scope.printOptions),$scope.printOptions.removeBind&&$el.removeClass("ng-binding ng-scope"),$scope.$on("$destroy",function(){$scope.$destroy(),$el.unbind("click")}),$el.bind("click",function(){var $target=angular.element($scope.printOptions.target);if($target.size()>1)return $target.eq(0).print(),!1;if(!$target.size())return $scope.printOptions.alert&&alert("Target not specified!"),!1;var strFrameName="printer-"+(new Date).getTime(),jFrame=angular.element('<iframe name="'+strFrameName+'">');jFrame.css("width","1px").css("height","1px").css("position","absolute").css("left","-9999px").appendTo(angular.element("body:first"));var objFrame=window.frames[strFrameName],objDoc=objFrame.document,jStyleDiv=angular.element("<div>").append(angular.element("style").clone());objDoc.open(),objDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'),objDoc.write("<html>"),objDoc.write("<body>"),objDoc.write("<head>"),objDoc.write("<title>"),objDoc.write($scope.printOptions.title||document.title),$scope.printOptions.css.length>0&&angular.forEach($scope.printOptions.css,function(stylesheet){objDoc.write('<link href="'+stylesheet+'" rel="stylesheet"/>')}),objDoc.write("</title>"),objDoc.write(jStyleDiv.html()),objDoc.write("</head>"),objDoc.write($target.html()),objDoc.write("</body>"),objDoc.write("</html>"),objDoc.close(),objFrame.focus(),objFrame.print(),setTimeout(function(){return jFrame.remove(),!0},6e4)})}}}}),angular.module("keepr.filters").filter("camelCase",["$filter",function($filter){return function(input,firstWordWithCase){(null===input||void 0===input)&&(input="");var $trim=$filter("trim");return firstWordWithCase&&(input=$filter("capitalize")(input)),$trim(input).replace(/[-_\s]+(.)?/g,function(match,c){return c.toUpperCase()})}}]),angular.module("keepr.filters").filter("capitalize",function(){return function(input){var str;return(void 0===input||null===input)&&(input=""),str=String(input),str.charAt(0).toUpperCase()+str.substring(1)}}),angular.module("keepr.filters").filter("charactersQuantity",function(){return function(input,chars,breakOnWord){if(isNaN(chars))return input;if(0>=chars)return"";if(input&&input.length>chars){if(input=input.substring(0,chars),breakOnWord)for(;" "===input.charAt(input.length-1);)input=input.substr(0,input.length-1);else{var lastspace=input.lastIndexOf(" ");-1!==lastspace&&(input=input.substr(0,lastspace))}return input+"..."}return input}}),angular.module("keepr.filters").filter("conditional",function(){return function(input,trueCase,falseCase){return input===trueCase?trueCase:falseCase}}),angular.module("keepr.filters").filter("encodeUri",function(){return function(input){return void 0===input||null===input?"":encodeURIComponent(input)}}),angular.module("keepr.filters").filter("inflector",function(){function ucwords(text){return text.replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase()})}function breakup(text,separator){return text.replace(/[A-Z]/g,function(match){return separator+match})}var inflectors={humanize:function(value){return ucwords(breakup(value," ").split("_").join(" "))},underscore:function(value){return value.substr(0,1).toLowerCase()+breakup(value.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(value){return value=value.substr(0,1).toLowerCase()+ucwords(value.split("_").join(" ")).substr(1).split(" ").join("")}};return function(input,inflector){return inflector!==!1&&angular.isString(input)?(inflector=inflector||"humanize",inflectors[inflector](input)):input}}),angular.module("keepr.filters").filter("list",function(){return function(input,separator){return(null===separator||void 0===separator)&&(separator=", "),input.join(separator)}}),angular.module("keepr.filters").filter("max",function(){return function(input,elementKey){var out;if(input){(void 0===elementKey||null===elementKey)&&(elementKey=!1);for(var i in input)elementKey?"undefined"!=typeof input[i][elementKey]&&(input[i][elementKey]>out||void 0===out||null===out)&&(out=input[i][elementKey]):(input[i]>out||void 0===out||null===out)&&(out=input[i]);return out}}}),angular.module("keepr.filters").filter("min",function(){return function(input){var out;if(input){for(var i in input)(input[i]<out||void 0===out||null===out)&&(out=input[i]);return out}}}),angular.module("keepr.filters").filter("snakeCase",["$filter",function($filter){return function(input){(null===input||void 0===input)&&(input="");var $trim=$filter("trim");return $trim(input).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()}}]),angular.module("keepr.filters").filter("startFrom",function(){return function(input,start){return start=+start,"object"==typeof input&&input.length>0?input.slice(start):[]}}),angular.module("keepr.filters").filter("trim",function(){return function(input){var str;return(void 0===input||null===input)&&(input=""),str=String(input),null!==String.prototype.trim?str.trim():str.replace(/^\s+|\s+$/gm,"")}}),angular.module("keepr.filters").filter("uncapitalize",function(){return function(input){var str;return(void 0===input||null===input)&&(input=""),str=String(input),str.charAt(0).toLowerCase()+str.substring(1)}}),angular.module("keepr.filters").filter("unique",["$parse",function($parse){return function(items,filterOn){if(filterOn===!1)return items;if((filterOn||angular.isUndefined(filterOn))&&angular.isArray(items)){var newItems=[],get=angular.isString(filterOn)?$parse(filterOn):function(item){return item},extractValueToCompare=function(item){return angular.isObject(item)?get(item):item};angular.forEach(items,function(item){for(var isDuplicate=!1,i=0;i<newItems.length;i++)if(angular.equals(extractValueToCompare(newItems[i]),extractValueToCompare(item))){isDuplicate=!0;break}isDuplicate||newItems.push(item)}),items=newItems}return items}}]),angular.module("keepr.filters").filter("validateEmail",function(){return function(input){if(null===input||void 0===input)return!1;var emailRegex=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;return emailRegex.test(input)}}),angular.module("keepr.filters").filter("wordsQuantity",function(){return function(input,words){if(isNaN(words))return input;if(0>=words)return"";if(input){var inputWords=input.split(/\s+/);inputWords.length>words&&(input=inputWords.slice(0,words).join(" ")+"...")}return input}}),angular.module("keepr.services").service("AlertService",function($rootScope,$timeout){$rootScope.alerts=[];var alertService={add:function(type,msg,timeout){if($rootScope.alerts.push({type:type,msg:msg}),timeout){var index=$rootScope.alerts.length-1;$timeout(function(){alertService.closeAlertMessage(index)},timeout)}},closeAlertMessage:function(index){return $rootScope.alerts.splice(index,1)},clear:function(){$rootScope.alerts=[]}};return $rootScope.closeAlertMessage=alertService.closeAlertMessage,alertService}),angular.module("keepr.services").service("CryptoOfflineStorageService",function(){var loadCrypto="undefined"!=typeof CryptoJS;return{secret:"",storageType:"localStorage",init:function(opts){angular.extend(this,opts)},encrypt:function(object,secret){var message=loadCrypto?JSON.stringify(object):object;return loadCrypto?CryptoJS.TripleDES.encrypt(message,secret):JSON.stringify(object)},decrypt:function(encrypted,secret){if("undefined"==typeof encrypted)return"";var decrypted=loadCrypto?CryptoJS.TripleDES.decrypt(encrypted,secret):JSON.parse(encrypted);return loadCrypto?JSON.parse(decrypted.toString(CryptoJS.enc.Utf8)):decrypted},get:function(key){var encrypted=window[this.storageType].getItem(key);return encrypted&&this.decrypt(encrypted,this.secret)},set:function(key,object){if(!object)return this.remove(key),!1;var encrypted=this.encrypt(object,this.secret);return window[this.storageType].setItem(key,encrypted),!0},remove:function(key){return window[this.storageType].removeItem(key),!0}}}),angular.module("keepr.services").factory("HttpModel",function($q,$http,$filter){var _params={url:"",type:"_ngCache"+Math.floor(1e6*Math.random()+1),cache:!0};return{_params:_params,_cache:!1,init:function(params){var self=this;return angular.extend(self._params,params),self},_getCacheInfo:function(){if(this._cache!==!1)return this._cache;var item=window.sessionStorage.getItem(this._params.type);return null!==item?item:!1},_setCacheInfo:function(data){this._cache=data,window.sessionStorage.setItem(this._params.type,data)},$get:function(url){var deferred=$q.defer();if(this._params.cache&&this._getCacheInfo()!==!1)deferred.resolve(this._getCacheInfo());else{var self=this;$http.get(this._params.url+url).success(function(data){self._setCacheInfo(data),deferred.resolve(data)}).error(function(error){deferred.reject(error)})}return deferred.promise},$find:function(url,params){var deferred=$q.defer();return this.$get(url).then(function(data){var result=$filter("filter")(data,params);deferred.resolve(result)}),deferred.promise},$post:function(url,params,headers){params=params||{},headers=headers||{};var deferred=$q.defer();return $http.post(this._params.url+url,params,headers).success(function(data){deferred.resolve(data)}).error(function(error){deferred.reject(error)}),deferred.promise},$put:function(url,params,headers){params=params||{},headers=headers||{};var deferred=$q.defer();return $http.put(this._params.url+url,params,headers).success(function(data){deferred.resolve(data)}).error(function(error){deferred.reject(error)}),deferred.promise},$delete:function(url){var deferred=$q.defer();return $http.delete(this._params.url+url).success(function(data){deferred.resolve(data)}).error(function(error){deferred.reject(error)}),deferred.promise}}}),angular.module("keepr.services").service("NotifyService",function($rootScope){var baseNotification=function(){function getNotification(title,options){var notification;return window.Notification?notification=new window.Notification(title,{icon:isString(options.icon)?options.icon:options.icon.x32,body:options.body||emptyString,tag:options.tag||emptyString}):window.webkitNotifications?(notification=window.webkitNotifications.createNotification(options.icon,title,options.body),notification.show()):navigator.mozNotification?(notification=navigator.mozNotification.createNotification(title,options.body,options.icon),notification.show()):window.external&&window.external.msIsSiteMode()&&(window.external.msSiteModeClearIconOverlay(),window.external.msSiteModeSetIconOverlay(isString(options.icon)?options.icon:options.icon.x16,title),window.external.msSiteModeActivate(),notification={ieVerification:ieVerification+1}),notification}function getWrapper(notification){return{close:function(){notification&&(notification.close?notification.close():window.external&&window.external.msIsSiteMode()&&notification.ieVerification===ieVerification&&window.external.msSiteModeClearIconOverlay())}}}function requestPermission(callback){if(isSupported){var callbackFunction=isFunction(callback)?callback:noop;window.webkitNotifications&&window.webkitNotifications.checkPermission?window.webkitNotifications.requestPermission(callbackFunction):window.Notification&&window.Notification.requestPermission&&window.Notification.requestPermission(callbackFunction)}}function permissionLevel(){var permission;if(isSupported)return window.Notification&&window.Notification.permissionLevel?permission=window.Notification.permissionLevel():window.webkitNotifications&&window.webkitNotifications.checkPermission?permission=PERMISSION[window.webkitNotifications.checkPermission()]:navigator.mozNotification?permission=PERMISSION_GRANTED:window.Notification&&window.Notification.permission?permission=window.Notification.permission:window.external&&void 0!==window.external.msIsSiteMode()&&(permission=window.external.msIsSiteMode()?PERMISSION_GRANTED:PERMISSION_DEFAULT),permission}function config(params){return params&&isObject(params)&&mixin(settings,params),settings}function isDocumentHidden(){return settings.pageVisibility?document.hidden||document.msHidden||document.mozHidden||document.webkitHidden:!0}function createNotification(title,options){var notification,notificationWrapper;return isSupported&&isDocumentHidden()&&isString(title)&&options&&(isString(options.icon)||isObject(options.icon))&&permissionLevel()===PERMISSION_GRANTED&&(notification=getNotification(title,options)),notificationWrapper=getWrapper(notification),settings.autoClose&&notification&&!notification.ieVerification&&notification.addEventListener&&notification.addEventListener("show",function(){var notification=notificationWrapper;window.setTimeout(function(){notification.close()},settings.autoClose)}),notificationWrapper}var PERMISSION_DEFAULT="default",PERMISSION_GRANTED="granted",PERMISSION_DENIED="denied",PERMISSION=[PERMISSION_GRANTED,PERMISSION_DEFAULT,PERMISSION_DENIED],defaultSetting={pageVisibility:!1,autoClose:0},empty={},emptyString="",isSupported=function(){var isSupported=!1;try{isSupported=!!(window.Notification||window.webkitNotifications||navigator.mozNotification||window.external&&void 0!==window.external.msIsSiteMode())}catch(e){console.error(e.message)}return isSupported}(),ieVerification=Math.floor(10*Math.random()+1),isFunction=function(value){return value&&value.constructor===Function},isString=function(value){return value&&value.constructor===String},isObject=function(value){return value&&value.constructor===Object},mixin=function(target,source){var name,s;for(name in source)s=source[name],name in target&&(target[name]===s||name in empty&&empty[name]===s)||(target[name]=s);return target},noop=function(){},settings=defaultSetting,BaseNotification={PERMISSION_DEFAULT:PERMISSION_DEFAULT,PERMISSION_GRANTED:PERMISSION_GRANTED,PERMISSION_DENIED:PERMISSION_DENIED,isSupported:isSupported,config:config,createNotification:createNotification,permissionLevel:permissionLevel,requestPermission:requestPermission};return isFunction(Object.seal)&&Object.seal(BaseNotification),BaseNotification},BaseNotification=baseNotification(),statusClass={},isIE=!1,isSupported=BaseNotification.isSupported,messages={notPinned:"Pin current page in the taskbar in order to receive notifications",notSupported:"<strong>Desktop Notifications not supported!</strong> Check supported browsers table and project's GitHub page."};$rootScope.notification={title:"Notification Title",body:"Notification Body",icon:"img/beauthumb.jpg"},$rootScope.permissionLevel=BaseNotification.permissionLevel(),$rootScope.permissionsGranted=$rootScope.permissionLevel===BaseNotification.PERMISSION_GRANTED;try{isIE=window.external&&void 0!==window.external.msIsSiteMode()}catch(e){}return statusClass[BaseNotification.PERMISSION_DEFAULT]="alert",statusClass[BaseNotification.PERMISSION_GRANTED]="alert alert-success",statusClass[BaseNotification.PERMISSION_DENIED]="alert alert-error",messages[BaseNotification.PERMISSION_DEFAULT]="<strong>Warning!</strong> Click to allow displaying desktop notifications.",messages[BaseNotification.PERMISSION_GRANTED]="<strong>Success!</strong>",messages[BaseNotification.PERMISSION_DENIED]="<strong>Denied!</strong>",$rootScope.status=isSupported?statusClass[$rootScope.permissionLevel]:statusClass[BaseNotification.PERMISSION_DENIED],$rootScope.message=isSupported?isIE?messages.notPinned:messages[$rootScope.permissionLevel]:messages.notSupported,$rootScope.requestPermission=function(){$rootScope.permissionLevel===BaseNotification.PERMISSION_DEFAULT&&BaseNotification.requestPermission(function(){$rootScope.$apply($rootScope.permissionLevel=BaseNotification.permissionLevel()),$rootScope.$apply($rootScope.permissionsGranted=$rootScope.permissionLevel===BaseNotification.PERMISSION_GRANTED),$rootScope.$apply($rootScope.status=isSupported?statusClass[$rootScope.permissionLevel]:statusClass[BaseNotification.PERMISSION_DENIED]),$rootScope.$apply($rootScope.message=isSupported?isIE?messages.notPinned:messages[$rootScope.permissionLevel]:messages.notSupported)})},$rootScope.showNotification=function(title,body,icon){BaseNotification.createNotification(title,{body:body,icon:void 0!==icon?icon:$rootScope.notification.icon})},$rootScope}),angular.module("keepr.services").factory("OfflineModel",function($filter,CryptoOfflineStorageService){var _key=null,_items=null,_fields=null;return{_secret:"my-awesome-key",init:function(key,_items,fields,params){var self=this;_fields=fields||null,_key=key,params=params||{},angular.extend(self,params),CryptoOfflineStorageService.init({secret:self._secret});var _itemsCached=CryptoOfflineStorageService.get(_key);if(null!==_itemsCached?_items=_itemsCached:angular.isArray(_items)||(_items=[]),null!==_fields)for(var _itemsLength=_items.length,i=0;_itemsLength>i;i++)_items[i]=this.createValueObject(_items[i]);return CryptoOfflineStorageService.set(_key,_items),self.setListItems(_items,params),self},createValueObject:function(item){var obj={};return angular.forEach(_fields,function(field){obj[field]=item[field]||""}),obj},setKey:function(key){return _key=key,this},getKey:function(){return _key},setListItems:function(items){return _items=items,this},getListItems:function(){return _items},setFields:function(fields){return _fields=fields,this},countTotalItems:function(items){return($filter("max")(items,"_id")||0)+1},create:function(item){return item=this.createValueObject(item),item._id=this.countTotalItems(_items),_items.push(item),CryptoOfflineStorageService.set(_key,_items),_items},update:function(item){return _items=_items.map(function(element){return element._id===item._id&&(element=item),element}),CryptoOfflineStorageService.set(_key,_items),_items},"delete":function(index){var db=this.getListItems(),_id=db.filter(function(element,pos){return element._id===index?(element.pos=pos,element):void 0});if(_id.length>0){var item=db.splice(_id[0].pos,1);if("object"==typeof item[0])return this.setListItems(db),CryptoOfflineStorageService.set(_key,db),item[0]}return!1}}}),angular.module("keepr.services").factory("Speech",function(){var msg;return window.speechSynthesis&&(msg=new window.SpeechSynthesisUtterance,window.speechSynthesis.getVoices()),{_msg:msg,sayText:function(text,config){var voices=window.speechSynthesis.getVoices();return this._msg.voice=void 0!==config.voiceIndex?voices[config.voiceIndex]:voices[0],this._msg.volume=void 0!==config.volume?config.volume:1,this._msg.rate=void 0!==config.rate?config.rate:1,this._msg.pitch=void 0!==config.pitch?config.pitch:1,this._msg.text=text,window.speechSynthesis.speak(this._msg),!0}}});
})(window, window.angular);